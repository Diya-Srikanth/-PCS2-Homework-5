from Bio import SeqIO
import pandas as pd

def edit(str1, str2, m, n):
    blosum = pd.DataFrame([
    ['4', '0', '-2', '-1', '-2', '0', '-2', '-1', '-1', '-1', '-1', '-2', '-1', '-1', '-1', '1', '0', '0', '-3', '-2'],
    ['0', '9', '-3', '-4', '-2', '-3', '-3', '-1', '-3', '-1', '-1', '-3', '-3', '-3', '-3', '-1', '-1', '-1', '-2', '-2'],
    ['-2', '-3', '6', '2', '-3', '-1', '-1', '-3', '-1', '-4', '-3', '1', '-1', '0', '-2', '0', '-1', '-3', '-4', '-3'],
    ['-1', '-4', '2', '5', '-3', '-2', '0', '-3', '1', '-3', '-2', '0', '-1', '2', '0', '0', '-1', '-2', '-3', '-2'],
    ['-2', '-2', '-3', '-3', '6', '-3', '-1', '0', '-3', '0', '0', '-3', '-4', '-3', '-3', '-2', '-2', '-1', '1', '3'],
    ['0', '-3', '-1', '-2', '-3', '6', '-2', '-4', '-2', '-4', '-3', '0', '-2', '-2', '-2', '0', '-2', '-3', '-2', '-3'],
    ['-2', '-3', '-1', '0', '-1', '-2', '8', '-3', '-1', '-3', '-2', '1', '-2', '0', '0', '-1', '-2', '-3', '-2', '2'],
    ['-1', '-1', '-3', '-3', '0', '-4', '-3', '4', '-3', '2', '1', '-3', '-3', '-3', '-3', '-2', '-1', '3', '-3', '-1'],
    ['-1', '-3', '-1', '1', '-3', '-2', '-1', '-3', '5', '-2', '-1', '0', '-1', '1', '2', '0', '-1', '-2', '-3', '-2'],
    ['-1', '-1', '-4', '-3', '0', '-4', '-3', '2', '-2', '4', '2', '-3', '-3', '-2', '-2', '-2', '-1', '1', '-2', '-1'],
    ['-1', '-1', '-3', '-2', '0', '-3', '-2', '1', '-1', '2', '5', '-2', '-2', '0', '-1', '-1', '-1', '1', '-1', '-1'],
    ['-2', '-3', '1', '0', '-3', '0', '1', '-3', '0', '-3', '-2', '6', '-2', '0', '0', '1', '0', '-3', '-4', '-2'],
    ['-1', '-3', '-1', '-1', '-4', '-2', '-2', '-3', '-1', '-3', '-2', '-2', '7', '-1', '-2', '-1', '-1', '-2', '-4', '-3'],
    ['-1', '-3', '0', '2', '-3', '-2', '0', '-3', '1', '-2', '0', '0', '-1', '5', '1', '0', '-1', '-2', '-2', '-1'],
    ['-1', '-3', '-2', '0', '-3', '-2', '0', '-3', '2', '-2', '-1', '0', '-2', '1', '5', '-1', '-1', '-3', '-3', '-2'],
    ['1', '-1', '0', '0', '-2', '0', '-1', '-2', '0', '-2', '-1', '1', '-1', '0', '-1', '4', '1', '-2', '-3', '-2'],
    ['0', '-1', '-1', '-1', '-2', '-2', '-2', '-1', '-1', '-1', '-1', '0', '-1', '-1', '-1', '1', '5', '0', '-2', '-2'],
    ['0', '-1', '-3', '-2', '-1', '-3', '-3', '3', '-2', '1', '1', '-3', '-2', '-2', '-3', '-2', '0', '4', '-3', '-1'],
    ['-3', '-2', '-4', '-3', '1', '-2', '-2', '-3', '-3', '-2', '-1', '-4', '-4', '-2', '-3', '-3', '-2', '-3', '11', '2'],
    ['-2', '-2', '-3', '-2', '3', '-3', '2', '-1', '-2', '-1', '-1', '-2', '-3', '-1', '-2', '-2', '-2', '-1', '2', '7']],
    index = ["A","C","D","E","F","G","H","I","K","L","M","N","P","Q","R","S","T","V","W","Y"],
    columns=["A","C","D","E","F","G","H","I","K","L","M","N","P","Q","R","S","T","V","W","Y"])
    dp = [[0 for x in range(n + 1)] for x in range(m + 1)]
    for i in range(1,m + 1):
        dp[i][0] = i*(-5)
    for i in range(1,n + 1):
        dp[0][i] = i*(-5)
    for i in range(1,m + 1):
        for j in range(1,n + 1):
            c1 = int(blosum[str1[i-1]][str2[j-1]])
            dp[i][j] = max(dp[i-1][j]-5,dp[i][j-1]-5,dp[i-1][j-1]+c1)

    return dp[m][n]


if __name__ == "__main__":
    strings=[]
    with open("rosalind_glob.txt") as file:
        for info in SeqIO.parse(file, "fasta"):
            strings.append(info.seq)
    str1 , str2 = strings
    print(edit(str1, str2, len(str1), len(str2)))